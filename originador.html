<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <title>Originador | Cadena Génesis</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free Website Template" name="keywords">
    <meta content="Free Website Template" name="description">
    <link href="img/favicon.ico" rel="icon">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;400&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet"> 
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/tempusdominus/css/tempusdominus-bootstrap-4.min.css" rel="stylesheet" />
    <link href="css/style.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/originador.css">    
    <script src="BlockChain.js"></script>
</head>
<body>
    <!-- Navbar Start -->
    <div class="container-fluid p-0 nav-bar">
        <nav class="navbar navbar-expand-lg bg-none navbar-dark py-3">
            <a href="index.html" class="navbar-brand px-lg-4 m-0">
                <h1 class="m-0 display-4 text-uppercase text-white">KOPPEE</h1>
            </a>
            <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
                <div class="navbar-nav ml-auto p-4">
                    <a href="index.html" class="nav-item nav-link">Home</a>
                    <a href="agregador.html" class="nav-item nav-link">Agregador</a>
                    <a href="validador.html" class="nav-item nav-link">Validador</a>
                </div>
            </div>
        </nav>
    </div>
    <!-- Navbar End -->
    <!-- Page Header Start -->
    <div class="container-fluid page-header mb-5 position-relative overlay-bottom">
        <div class="d-flex flex-column align-items-center justify-content-center" style="min-height: 400px">
            <h1 class="display-3 text-white mt-5">ORIGINADOR</h1>
            <div class="d-inline-flex text-white">
                <p class="m-0"><a class="text-white" href="index.html">Home</a></p>
                <p class="m-0 px-2">/</p>
                <p class="m-0">Originador</p>
            </div>
        </div>
    </div>
    <!-- Page Header End -->
    <div class="form-section">
      <form id="genesisForm">
    <label for="chainName">Nombre de la cadena:</label>
    <input type="text" id="chainName" name="chainName" required placeholder="Ej: CafePremium2024">
    
    <label for="type">Tipo de producto:</label>
    <select id="type" name="type">
        <option value="Café Verde">Café Verde</option>
        <option value="Café Tostado">Café Tostado</option>
        <option value="Otro">Otro</option>
    </select>
    
    <label for="element">Descripción inicial:</label>
    <input type="text" id="element" name="element" required placeholder="Ej: Lote #123, finca, origen...">
    
    <button type="submit">Crear Cadena Génesis</button>
</form>



<div id="genesisSuccess" style="display:none; margin-top:10px; color:green; font-weight:bold;"></div>

<script>
document.getElementById('genesisForm').onsubmit = function(e) {
    e.preventDefault();
    const name = document.getElementById('chainName').value;
    const typeValue = document.getElementById('type').value;
    const element = document.getElementById('element').value;

    if (window.Blockchain) {
        // Crear blockchain y obtener bloque génesis
        const bc = new window.Blockchain({ 
            nombre: name, 
            tipo: typeValue, 
            descripcion: element 
        });

        // Tomar el bloque génesis ya creado
        const genesisBlock = bc.chain[0];

        // Objeto a guardar en localStorage
        let chainObj = {
            name: name,
            chain: [genesisBlock]  // guardamos SOLO bloques planos
        };

        // Recuperar cadenas existentes
        let chains = JSON.parse(localStorage.getItem('chains') || '[]');
        chains.push(chainObj);

        // Guardar en localStorage
        localStorage.setItem('chains', JSON.stringify(chains));

        document.getElementById('genesisSuccess').style.display = 'block';
        document.getElementById('genesisSuccess').textContent = `Cadena "${name}" creada con éxito.`;
    } else {
        alert('BlockChain.js no está cargado correctamente.');
    }
};
</script>
</div>  
<div class="container-fluid text-white mt-5 px-0" style="background: #1b1b1b;">
        <div class="row px-5 py-4">
            <div class="col-lg-6 col-md-6 mb-4 mb-md-0">
                <h2 class="text-white">KOPPEE</h2>
                <p class="mb-0">Café de calidad y trazabilidad blockchain.</p>
            </div>
            <div class="col-lg-6 col-md-6 text-md-right">
                <div class="d-inline-flex align-items-center">
                    <a class="text-white px-2" href="index.html">Home</a>
                    <a class="text-white px-2" href="about.html">About</a>
                    <a class="text-white px-2" href="service.html">Service</a>
                    <a class="text-white px-2" href="menu.html">Menu</a>
                    <a class="text-white px-2" href="originador.html">Originador</a>
                    <a class="text-white px-2" href="agregador.html">Agregador</a>
                    <a class="text-white px-2" href="validador.html">Validador</a>
                    <a class="text-white px-2" href="contact.html">Contact</a>
                </div>
            </div>
        </div>
        <div class="row px-5 pb-3">
            <div class="col-12 text-center">
                <small>© 2025 KOPPEE. Todos los derechos reservados.</small>
            </div>
        </div>
    </div>
</body>
</html>
